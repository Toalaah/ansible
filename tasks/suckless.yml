---
- name: set variables
  ansible.builtin.set_fact:
    installation_dir: "{{ lookup('env', 'HOME') }}/.config"
    progs:
      - { name: 'dwm',       repo: 'https://github.com/toalaah/dwm.git' }
      - { name: 'st',        repo: 'https://github.com/toalaah/st.git' }
      - { name: 'dwmblocks', repo: 'https://github.com/toalaah/dwmblocks.git' }
      - { name: 'dmenu',     repo: 'https://github.com/toalaah/dmenu.git' }

- name: clone suckless programs
  ansible.builtin.git: { repo: "{{ item.repo }}", dest: "{{ installation_dir }}/{{ item.name }}", accept_newhostkey: 'yes' }
  loop: "{{ progs }}"

- name: build suckless programs
  make: { chdir: "{{ installation_dir }}/{{ item.name }}", target: install }
  loop: "{{ progs }}"
  become: true
